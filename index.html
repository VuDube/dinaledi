<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DINALEDI | Jabulani FM</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Dinaledi">
    <meta name="application-name" content="Dinaledi">
    <meta name="theme-color" content="#FFD700">
    <meta name="mobile-web-app-capable" content="yes">
    
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@800;900&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { brand: { black: '#000000', yellow: '#FFD700', white: '#FFFFFF' } },
                    fontFamily: { logo: ['Montserrat', 'sans-serif'], body: ['Inter', 'sans-serif'] }
                }
            }
        }
    </script>

    <style>
        body { background-color: #000; color: #fff; overflow: hidden; font-family: 'Inter', sans-serif; }
        .brand-a { color: #FFD700; text-shadow: 0 0 15px rgba(255, 215, 0, 0.5); }
        input[type="number"]::-webkit-inner-spin-button, 
        input[type="number"]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        .error-shake { animation: shake 0.4s; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        
        /* Smooth Install UI */
        .animate-bounce-in { animation: bounceIn 0.5s ease-out; }
        @keyframes bounceIn {
            0% { transform: translateY(100%); opacity: 0; }
            60% { transform: translateY(-10%); opacity: 1; }
            100% { transform: translateY(0); }
        }
    </style>
</head>
<body class="h-screen w-full flex flex-col items-center justify-center relative bg-brand-black">

    <div class="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-gray-900 via-black to-black opacity-80 z-0"></div>

    <div class="z-10 flex flex-col items-center text-center space-y-12 w-full px-6">
        <h1 class="font-logo font-black text-5xl md:text-7xl lg:text-9xl tracking-widest select-none">
            DIN<span class="brand-a">A</span>LEDI
        </h1>

        <div class="w-full max-w-xs space-y-4">
            <div class="relative group">
                <div class="absolute -inset-1 bg-brand-yellow rounded-2xl blur opacity-20 group-hover:opacity-40 transition duration-1000"></div>
                <div class="relative bg-black border-2 border-brand-yellow/30 rounded-2xl p-6 space-y-4">
                    <p class="text-brand-yellow text-sm font-bold tracking-widest uppercase">Enter Access Pin</p>
                    <input type="number" id="pinInput" inputmode="numeric" placeholder="••••" 
                           class="w-full bg-transparent text-center text-4xl tracking-[1rem] font-black text-brand-yellow focus:outline-none placeholder-yellow-900/50"
                           oninput="if(this.value.length > 4) this.value = this.value.slice(0, 4)">
                    <button onclick="handleLogin()" 
                            class="w-full py-4 bg-brand-yellow text-black font-logo font-bold uppercase tracking-widest rounded-xl hover:scale-[1.02] active:scale-95 transition-all">
                        Login
                    </button>
                </div>
            </div>
            <p id="errorMsg" class="text-red-500 text-xs font-bold opacity-0 transition-opacity">INVALID PIN - TRY AGAIN</p>
        </div>
    </div>

    <div id="iosModal" class="fixed inset-0 z-50 flex items-end justify-center px-4 pb-10 bg-black/60 hidden">
        <div class="bg-zinc-900 border border-zinc-800 w-full max-w-sm rounded-3xl p-6 text-center animate-bounce-in">
            <p class="text-white text-lg font-bold mb-2">Install Dinaledi App</p>
            <p class="text-zinc-400 text-sm mb-6">Tap the <span class="text-blue-500">Share</span> icon below and then <span class="text-white font-bold">"Add to Home Screen"</span>.</p>
            <button onclick="document.getElementById('iosModal').classList.add('hidden')" class="text-brand-yellow font-bold uppercase text-sm">Close</button>
        </div>
    </div>

    <script src="/sw-register.js"></script>
    <script>
        function handleLogin() {
            const pin = document.getElementById('pinInput').value;
            const error = document.getElementById('errorMsg');
            if (pin === "1235") {
                window.location.href = "https://dinaledi.jabulanifm.com";
            } else {
                error.classList.remove('opacity-0');
                document.getElementById('pinInput').classList.add('error-shake');
                setTimeout(() => {
                    document.getElementById('pinInput').classList.remove('error-shake');
                }, 400);
            }
        }

        // Native PWA Install Trigger
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
        });

        async function triggerInstall() {
            const isIos = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
            const isStandalone = window.matchMedia('(display-mode: standalone)').matches;

            if (isIos && !isStandalone) {
                document.getElementById('iosModal').classList.remove('hidden');
            } else if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                deferredPrompt = null;
            }
        }

        window.onload = () => {
            setTimeout(triggerInstall, 3000);
        };
    </script>
</body>
</html>
